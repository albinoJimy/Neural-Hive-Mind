metadata:
  version: "1.0.0"
  description: "Configuração centralizada para o Fluxo C (Consensus Engine + Orchestrator Dynamic) em ambiente local"
  createdAt: "2025-11-19"

namespace:
  name: "consensus-orchestration"
  labels:
    neural-hive-mind.org/layer: "cognitiva"
    neural-hive-mind.org/flow: "fluxo-c"

consensusEngine:
  releaseName: "consensus-engine"
  replicas: 1 # Ambiente local sem HA
  image:
    repository: "neural-hive-mind/consensus-engine"
    tag: "1.0.12"
    pullPolicy: "Never"
  resources:
    requests:
      cpu: "250m"
      memory: "512Mi"
    limits:
      cpu: "1"
      memory: "2Gi"
  service:
    type: "ClusterIP"
    port: 8000
    metricsPort: 8080
  config:
    environment: "local"
    logLevel: "DEBUG"
    kafka:
      bootstrapServers: "detect"
      consumerGroupId: "consensus-engine-local"
      plansTopicConsume: "plans.ready"
      consensusTopicProduce: "plans.consensus"
      securityProtocol: "PLAINTEXT"
    specialists:
      # Endpoints dos specialists no namespace semantic-translation
      businessEndpoint: "specialist-business.semantic-translation.svc.cluster.local:50051"
      technicalEndpoint: "specialist-technical.semantic-translation.svc.cluster.local:50051"
      behaviorEndpoint: "specialist-behavior.semantic-translation.svc.cluster.local:50051"
      evolutionEndpoint: "specialist-evolution.semantic-translation.svc.cluster.local:50051"
      architectureEndpoint: "specialist-architecture.semantic-translation.svc.cluster.local:50051"
      # Timeout increased to 120000ms (120 seconds) to accommodate specialist processing time of 49-66 seconds for ML inference
      grpcTimeoutMs: 120000
      grpcMaxRetries: 3
    mongodb:
      uri: "detect"
      database: "neural_hive"
      consensusCollection: "consensus_decisions"
    redis:
      clusterNodes: "detect"
      sslEnabled: false
      pheromoneTtl: 3600
      pheromoneDecayRate: 0.1
    openTelemetry:
      endpoint: "detect"
      samplingRate: 1.0
    consensus:
      minConfidenceScore: 0.7
      maxDivergenceThreshold: 0.05
      highRiskThreshold: 0.7
      criticalRiskThreshold: 0.9
      bayesianPriorWeight: 0.1
      votingWeightDecay: 0.95
      requireUnanimousForCritical: false
      fallbackToDeterministic: true
    features:
      enableBayesianAveraging: true
      enablePheromones: true
      enableFallback: true
      enableParallelInvocation: true
  probes:
    startup:
      initialDelaySeconds: 20
      periodSeconds: 10
      failureThreshold: 30
    liveness:
      initialDelaySeconds: 0
      periodSeconds: 10
    readiness:
      initialDelaySeconds: 0
      periodSeconds: 5
  secrets:
    kafkaSaslPassword: ""
    mongodbPassword: ""
    redisPassword: ""
  observability:
    serviceMonitor:
      enabled: true
      interval: "30s"
  security:
    istio:
      enabled: false
    networkPolicy:
      enabled: false

orchestratorDynamic:
  releaseName: "orchestrator-dynamic"
  replicas: 1 # Ambiente local sem HA
  image:
    repository: "neural-hive-mind/orchestrator-dynamic"
    tag: "1.0.12"
    pullPolicy: "Never"
  resources:
    requests:
      cpu: "250m"
      memory: "512Mi"
    limits:
      cpu: "1"
      memory: "2Gi"
  service:
    type: "ClusterIP"
    port: 8000
  config:
    environment: "local"
    logLevel: "DEBUG"
    temporal:
      host: "detect"
      port: 7233
      namespace: "default"
      tlsEnabled: false
    postgres:
      host: "detect"
      port: 5432
      database: "temporal"
      sslMode: "disable"
    kafka:
      bootstrapServers: "detect"
      consensusTopic: "plans.consensus"
      ticketsTopic: "execution.tickets"
      consumerGroupId: "orchestrator-dynamic-local"
      securityProtocol: "PLAINTEXT"
    mongodb:
      uri: "detect"
      database: "neural_hive_orchestration"
    redis:
      clusterNodes: "detect"
      sslEnabled: false
    openTelemetry:
      endpoint: "detect"
    scheduler:
      enableIntelligentScheduler: false # Desabilitado em local
      maxParallelTickets: 50
    optimizer:
      enabled: false # ML optimizer desabilitado
    ml:
      localLoadPrediction:
        enabled: false
    sla:
      defaultTimeoutMs: 1800000
      checkIntervalSeconds: 30
    retry:
      maxAttempts: 2
      initialIntervalMs: 1000
    vault:
      enabled: false
    spiffe:
      enabled: false
    opa:
      enabled: false
  probes:
    startup:
      initialDelaySeconds: 30
      periodSeconds: 10
      failureThreshold: 30
    liveness:
      initialDelaySeconds: 0
      periodSeconds: 10
    readiness:
      initialDelaySeconds: 0
      periodSeconds: 5
  secrets:
    postgresPassword: "temporal"
    kafkaSaslUsername: ""
    kafkaSaslPassword: ""
    mongodbPassword: ""
    redisPassword: ""
  observability:
    serviceMonitor:
      enabled: true
  security:
    istio:
      enabled: false
    networkPolicy:
      enabled: false
