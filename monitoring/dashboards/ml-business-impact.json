{
  "dashboard": {
    "title": "ML Business Impact & ROI",
    "tags": ["ml-ops", "business-impact", "roi", "efficiency", "specialists"],
    "timezone": "browser",
    "refresh": "30s",
    "time": {
      "from": "now-24h",
      "to": "now"
    },
    "templating": {
      "list": [
        {
          "name": "specialist",
          "type": "query",
          "query": "label_values(neural_hive_auto_approval_rate, specialist_type)",
          "multi": true,
          "includeAll": true,
          "current": {
            "selected": true,
            "text": "All",
            "value": "$__all"
          }
        },
        {
          "name": "time_range",
          "type": "custom",
          "query": "1h,6h,24h,7d,30d",
          "options": [
            {"text": "1h", "value": "1h", "selected": false},
            {"text": "6h", "value": "6h", "selected": false},
            {"text": "24h", "value": "24h", "selected": true},
            {"text": "7d", "value": "7d", "selected": false},
            {"text": "30d", "value": "30d", "selected": false}
          ],
          "current": {
            "selected": true,
            "text": "24h",
            "value": "24h"
          }
        }
      ]
    },
    "panels": [
      {
        "id": 100,
        "title": "Executive Summary",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0},
        "collapsed": false
      },
      {
        "id": 1,
        "title": "Auto-Approval Rate",
        "description": "Percentual de planos auto-aprovados com alta confiança (>0.9). Maior é melhor para eficiência.",
        "type": "gauge",
        "targets": [
          {
            "expr": "neural_hive_auto_approval_rate{specialist_type=~\"$specialist\", confidence_threshold=\"0.9\"}",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 6, "x": 0, "y": 1},
        "options": {
          "minVizWidth": 75,
          "minVizHeight": 75,
          "showThresholdLabels": false,
          "showThresholdMarkers": true
        },
        "fieldConfig": {
          "defaults": {
            "min": 0,
            "max": 1,
            "unit": "percentunit",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "red"},
                {"value": 0.4, "color": "yellow"},
                {"value": 0.6, "color": "green"}
              ]
            }
          }
        }
      },
      {
        "id": 2,
        "title": "Tempo Médio de Aprovação Humana",
        "description": "Tempo médio da criação da opinião até decisão humana. Menor é melhor.",
        "type": "stat",
        "targets": [
          {
            "expr": "avg(neural_hive_avg_approval_time_seconds{specialist_type=~\"$specialist\"})",
            "legendFormat": "Tempo Médio"
          }
        ],
        "gridPos": {"h": 8, "w": 6, "x": 6, "y": 1},
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "textMode": "value_and_name",
          "orientation": "auto"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "green"},
                {"value": 600, "color": "yellow"},
                {"value": 1800, "color": "orange"},
                {"value": 3600, "color": "red"}
              ]
            }
          }
        }
      },
      {
        "id": 3,
        "title": "Tempo Economizado em Revisões ($time_range)",
        "description": "Horas estimadas economizadas por auto-approvals. Assume 5 min por revisão manual.",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(neural_hive_time_saved_hours{specialist_type=~\"$specialist\"})",
            "legendFormat": "Total Horas Economizadas"
          }
        ],
        "gridPos": {"h": 8, "w": 6, "x": 12, "y": 1},
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "textMode": "value_and_name",
          "orientation": "auto"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "h",
            "decimals": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "text"},
                {"value": 10, "color": "green"},
                {"value": 50, "color": "blue"}
              ]
            }
          }
        }
      },
      {
        "id": 4,
        "title": "Model Uptime",
        "description": "Percentual de tempo que modelos estão saudáveis e disponíveis. Target: >99.5%",
        "type": "gauge",
        "targets": [
          {
            "expr": "neural_hive_model_uptime_percentage{specialist_type=~\"$specialist\"}",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 6, "x": 18, "y": 1},
        "options": {
          "minVizWidth": 75,
          "minVizHeight": 75,
          "showThresholdLabels": false,
          "showThresholdMarkers": true
        },
        "fieldConfig": {
          "defaults": {
            "min": 0.95,
            "max": 1,
            "unit": "percentunit",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0.95, "color": "red"},
                {"value": 0.98, "color": "yellow"},
                {"value": 0.995, "color": "green"}
              ]
            }
          }
        }
      },
      {
        "id": 101,
        "title": "Auto-Approval Efficiency",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 9},
        "collapsed": false
      },
      {
        "id": 5,
        "title": "Tendência da Taxa de Auto-Approval",
        "description": "Evolução da taxa de auto-approval ao longo do tempo por especialista",
        "type": "graph",
        "targets": [
          {
            "expr": "neural_hive_auto_approval_rate{specialist_type=~\"$specialist\", confidence_threshold=\"0.9\"}",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 10},
        "yaxes": [
          {
            "format": "percentunit",
            "label": "Taxa de Auto-Approval",
            "min": 0,
            "max": 1
          },
          {
            "format": "short",
            "show": false
          }
        ],
        "lines": true,
        "linewidth": 2,
        "fill": 1,
        "fillGradient": 3
      },
      {
        "id": 6,
        "title": "Auto-Approvals vs Revisões Manuais",
        "description": "Comparação de planos auto-aprovados vs revisados manualmente",
        "type": "graph",
        "targets": [
          {
            "expr": "sum by (specialist_type) (rate(neural_hive_auto_approvals_total{specialist_type=~\"$specialist\"}[$time_range]))",
            "legendFormat": "Auto: {{ specialist_type }}"
          },
          {
            "expr": "sum by (specialist_type) (rate(neural_hive_manual_reviews_total{specialist_type=~\"$specialist\"}[$time_range]))",
            "legendFormat": "Manual: {{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 10},
        "yaxes": [
          {
            "format": "ops",
            "label": "Planos/sec",
            "min": 0
          },
          {
            "format": "short",
            "show": false
          }
        ],
        "stack": true,
        "fill": 1,
        "linewidth": 1
      },
      {
        "id": 102,
        "title": "Análise de Tempo de Aprovação",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 18},
        "collapsed": false
      },
      {
        "id": 7,
        "title": "Distribuição de Tempo de Aprovação (P50, P95, P99)",
        "description": "Distribuição de tempos de aprovação humana por percentil",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.50, sum by (specialist_type, le) (rate(neural_hive_approval_time_seconds_bucket{specialist_type=~\"$specialist\"}[$time_range])))",
            "legendFormat": "{{ specialist_type }} P50"
          },
          {
            "expr": "histogram_quantile(0.95, sum by (specialist_type, le) (rate(neural_hive_approval_time_seconds_bucket{specialist_type=~\"$specialist\"}[$time_range])))",
            "legendFormat": "{{ specialist_type }} P95"
          },
          {
            "expr": "histogram_quantile(0.99, sum by (specialist_type, le) (rate(neural_hive_approval_time_seconds_bucket{specialist_type=~\"$specialist\"}[$time_range])))",
            "legendFormat": "{{ specialist_type }} P99"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 19},
        "yaxes": [
          {
            "format": "s",
            "label": "Tempo de Aprovação",
            "min": 0
          },
          {
            "format": "short",
            "show": false
          }
        ],
        "lines": true,
        "linewidth": 2
      },
      {
        "id": 8,
        "title": "Tempo Médio de Aprovação por Especialista",
        "description": "Tempo médio da opinião até decisão humana",
        "type": "barchart",
        "targets": [
          {
            "expr": "neural_hive_avg_approval_time_seconds{specialist_type=~\"$specialist\"}",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 19},
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "min": 0
          }
        }
      },
      {
        "id": 103,
        "title": "Economia de Tempo & ROI",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 27},
        "collapsed": false
      },
      {
        "id": 9,
        "title": "Tempo Economizado Acumulado",
        "description": "Total de horas economizadas por auto-approvals ao longo do tempo",
        "type": "graph",
        "targets": [
          {
            "expr": "sum by (specialist_type) (neural_hive_time_saved_hours{specialist_type=~\"$specialist\"})",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 28},
        "yaxes": [
          {
            "format": "h",
            "label": "Horas Economizadas",
            "min": 0
          },
          {
            "format": "short",
            "show": false
          }
        ],
        "lines": true,
        "linewidth": 2,
        "fill": 1,
        "fillGradient": 5
      },
      {
        "id": 10,
        "title": "Taxa de Economia de Tempo",
        "description": "Taxa de economia de tempo (horas/dia)",
        "type": "graph",
        "targets": [
          {
            "expr": "sum by (specialist_type) (rate(neural_hive_time_saved_hours{specialist_type=~\"$specialist\"}[1h])) * 24",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 28},
        "yaxes": [
          {
            "format": "h",
            "label": "Horas/Dia",
            "min": 0
          },
          {
            "format": "short",
            "show": false
          }
        ],
        "lines": true,
        "linewidth": 2,
        "fill": 1
      },
      {
        "id": 11,
        "title": "Tempo Estimado de Revisão por Plano",
        "description": "Estimativa configurada de tempo de revisão manual por plano",
        "type": "stat",
        "targets": [
          {
            "expr": "avg(neural_hive_estimated_review_time_per_plan_seconds{specialist_type=~\"$specialist\"})",
            "legendFormat": "Estimativa Média"
          }
        ],
        "gridPos": {"h": 4, "w": 6, "x": 0, "y": 36},
        "options": {
          "colorMode": "value",
          "graphMode": "none",
          "textMode": "value_and_name",
          "orientation": "auto"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "decimals": 0
          }
        }
      },
      {
        "id": 12,
        "title": "Total de Auto-Approvals ($time_range)",
        "description": "Total de planos auto-aprovados",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(increase(neural_hive_auto_approvals_total{specialist_type=~\"$specialist\"}[$time_range]))",
            "legendFormat": "Total"
          }
        ],
        "gridPos": {"h": 4, "w": 6, "x": 6, "y": 36},
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "textMode": "value_and_name",
          "orientation": "auto"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "text"},
                {"value": 100, "color": "green"},
                {"value": 1000, "color": "blue"}
              ]
            }
          }
        }
      },
      {
        "id": 13,
        "title": "Total de Revisões Manuais ($time_range)",
        "description": "Total de planos que necessitaram revisão manual",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(increase(neural_hive_manual_reviews_total{specialist_type=~\"$specialist\"}[$time_range]))",
            "legendFormat": "Total"
          }
        ],
        "gridPos": {"h": 4, "w": 6, "x": 12, "y": 36},
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "textMode": "value_and_name",
          "orientation": "auto"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "text"},
                {"value": 50, "color": "yellow"},
                {"value": 200, "color": "orange"}
              ]
            }
          }
        }
      },
      {
        "id": 14,
        "title": "Razão de Eficiência",
        "description": "Razão de auto-approvals sobre total de planos (maior é melhor)",
        "type": "gauge",
        "targets": [
          {
            "expr": "sum(rate(neural_hive_auto_approvals_total{specialist_type=~\"$specialist\"}[$time_range])) / (sum(rate(neural_hive_auto_approvals_total{specialist_type=~\"$specialist\"}[$time_range])) + sum(rate(neural_hive_manual_reviews_total{specialist_type=~\"$specialist\"}[$time_range])))",
            "legendFormat": "Eficiência"
          }
        ],
        "gridPos": {"h": 4, "w": 6, "x": 18, "y": 36},
        "options": {
          "minVizWidth": 75,
          "minVizHeight": 75,
          "showThresholdLabels": false,
          "showThresholdMarkers": true
        },
        "fieldConfig": {
          "defaults": {
            "min": 0,
            "max": 1,
            "unit": "percentunit",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "red"},
                {"value": 0.5, "color": "yellow"},
                {"value": 0.7, "color": "green"}
              ]
            }
          }
        }
      },
      {
        "id": 104,
        "title": "Disponibilidade de Modelos",
        "type": "row",
        "gridPos": {"h": 1, "w": 24, "x": 0, "y": 40},
        "collapsed": false
      },
      {
        "id": 15,
        "title": "Tendência de Uptime dos Modelos",
        "description": "Disponibilidade dos modelos ao longo do tempo (target: >99.5%)",
        "type": "graph",
        "targets": [
          {
            "expr": "neural_hive_model_uptime_percentage{specialist_type=~\"$specialist\"}",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 41},
        "yaxes": [
          {
            "format": "percentunit",
            "label": "Uptime",
            "min": 0.95,
            "max": 1
          },
          {
            "format": "short",
            "show": false
          }
        ],
        "lines": true,
        "linewidth": 2,
        "fill": 1,
        "thresholds": [
          {
            "colorMode": "critical",
            "fill": true,
            "line": true,
            "op": "lt",
            "value": 0.995,
            "yaxis": "left"
          }
        ]
      },
      {
        "id": 16,
        "title": "Downtime de Modelos (Total)",
        "description": "Total de downtime no período selecionado",
        "type": "stat",
        "targets": [
          {
            "expr": "sum by (specialist_type) (increase(neural_hive_model_downtime_total_seconds{specialist_type=~\"$specialist\"}[$time_range]))",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 6, "x": 12, "y": 41},
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "textMode": "value_and_name",
          "orientation": "vertical"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "green"},
                {"value": 60, "color": "yellow"},
                {"value": 300, "color": "orange"},
                {"value": 600, "color": "red"}
              ]
            }
          }
        }
      },
      {
        "id": 17,
        "title": "Falhas de Health Check",
        "description": "Total de falhas em health checks dos modelos",
        "type": "stat",
        "targets": [
          {
            "expr": "sum by (specialist_type) (increase(neural_hive_model_health_check_failures_total{specialist_type=~\"$specialist\"}[$time_range]))",
            "legendFormat": "{{ specialist_type }}"
          }
        ],
        "gridPos": {"h": 8, "w": 6, "x": 18, "y": 41},
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "textMode": "value_and_name",
          "orientation": "vertical"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "decimals": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {"value": 0, "color": "green"},
                {"value": 1, "color": "yellow"},
                {"value": 5, "color": "orange"},
                {"value": 10, "color": "red"}
              ]
            }
          }
        }
      }
    ],
    "annotations": {
      "list": [
        {
          "datasource": "Prometheus",
          "enable": true,
          "expr": "changes(neural_hive_model_uptime_percentage{specialist_type=~\"$specialist\"}[1m]) < -0.01",
          "iconColor": "red",
          "name": "Model Downtime",
          "titleFormat": "Downtime de Modelo Detectado"
        },
        {
          "datasource": "Prometheus",
          "enable": true,
          "expr": "ALERTS{alertname=~\".*BusinessMetrics.*|.*ModelUptime.*\"}",
          "iconColor": "orange",
          "name": "Business Metrics Alerts",
          "titleFormat": "{{alertname}}"
        }
      ]
    },
    "links": [
      {
        "title": "Business Metrics Dashboard",
        "url": "/d/business-metrics-dashboard",
        "type": "link",
        "icon": "dashboard",
        "targetBlank": false
      },
      {
        "title": "ML Feedback & Retraining",
        "url": "/d/ml-feedback-retraining",
        "type": "link",
        "icon": "dashboard",
        "targetBlank": false
      },
      {
        "title": "Continuous Learning Dashboard",
        "url": "/d/continuous-learning",
        "type": "link",
        "icon": "dashboard",
        "targetBlank": false
      }
    ],
    "schemaVersion": 38,
    "version": 1,
    "uid": "ml-business-impact"
  }
}
