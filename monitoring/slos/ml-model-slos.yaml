apiVersion: v1
kind: List
items:
  # SLO 1: F1 Score >= 0.75 (7 days)
  - apiVersion: neural-hive.io/v1
    kind: SLODefinition
    metadata:
      name: ml-model-f1-score
      namespace: neural-hive-mind
      labels:
        neural-hive.io/layer: cognicao
        neural-hive.io/service: specialists
        neural-hive.io/slo-category: ml-performance
    spec:
      name: "ML Model F1 Score"
      description: "F1 score dos modelos de specialists deve ser >= 0.75 para garantir qualidade das decisoes"
      sloType: CUSTOM
      serviceName: specialists
      component: ml-models
      layer: cognicao
      target: 0.75
      windowDays: 7
      sliQuery:
        metricName: neural_hive_mlflow_model_f1
        query: |
          avg_over_time(
            avg(neural_hive_mlflow_model_f1{specialist_type=~".+"}) [7d]
          )
        aggregation: avg
        labels:
          specialist_type: ".*"
      enabled: true
      metadata:
        owner: "ml-platform-team"
        review_frequency: "quarterly"
        business_impact: "high"
        justification: "F1 score balances precision and recall, critical for approval/rejection decisions"

  # SLO 2: Latency P95 < 100ms (24 hours)
  - apiVersion: neural-hive.io/v1
    kind: SLODefinition
    metadata:
      name: ml-model-latency-p95
      namespace: neural-hive-mind
      labels:
        neural-hive.io/layer: cognicao
        neural-hive.io/service: specialists
        neural-hive.io/slo-category: ml-performance
    spec:
      name: "ML Model Latency P95"
      description: "95% das avaliacoes de specialists devem completar em menos de 100ms"
      sloType: LATENCY
      serviceName: specialists
      component: ml-models
      layer: cognicao
      target: 0.95
      windowDays: 1
      sliQuery:
        metricName: neural_hive_specialist_evaluation_duration_seconds
        query: |
          histogram_quantile(0.95,
            sum(rate(neural_hive_specialist_evaluation_duration_seconds_bucket[5m])) by (le, specialist_type)
          ) < 0.1
        aggregation: p95
        labels:
          specialist_type: ".*"
      enabled: true
      metadata:
        owner: "ml-platform-team"
        review_frequency: "quarterly"
        business_impact: "high"
        justification: "Latency directly impacts user experience in approval flow"

  # SLO 3: Feedback Collection Rate >= 10% (7 days)
  - apiVersion: neural-hive.io/v1
    kind: SLODefinition
    metadata:
      name: ml-model-feedback-rate
      namespace: neural-hive-mind
      labels:
        neural-hive.io/layer: cognicao
        neural-hive.io/service: feedback-loop
        neural-hive.io/slo-category: ml-performance
    spec:
      name: "ML Feedback Collection Rate"
      description: "Taxa de coleta de feedback deve ser >= 10% para retreinamento efetivo"
      sloType: CUSTOM
      serviceName: feedback-loop
      component: ml-models
      layer: cognicao
      target: 0.10
      windowDays: 7
      sliQuery:
        metricName: neural_hive_feedback_submissions_total
        query: |
          sum(rate(neural_hive_feedback_submissions_total[7d]))
          /
          sum(rate(neural_hive_specialist_evaluations_total[7d]))
        aggregation: ratio
        labels: {}
      enabled: true
      metadata:
        owner: "ml-platform-team"
        review_frequency: "quarterly"
        business_impact: "medium"
        justification: "Minimum feedback rate needed for effective retraining (threshold: 100 feedbacks)"

  # SLO 4: Model Uptime >= 99.5% (30 days)
  - apiVersion: neural-hive.io/v1
    kind: SLODefinition
    metadata:
      name: ml-model-uptime
      namespace: neural-hive-mind
      labels:
        neural-hive.io/layer: cognicao
        neural-hive.io/service: specialists
        neural-hive.io/slo-category: ml-availability
    spec:
      name: "ML Model Uptime"
      description: "Disponibilidade dos modelos ML deve ser >= 99.5%"
      sloType: AVAILABILITY
      serviceName: specialists
      component: ml-models
      layer: cognicao
      target: 0.995
      windowDays: 30
      sliQuery:
        metricName: neural_hive_specialist_evaluations_total
        query: |
          1 - (
            sum(rate(neural_hive_specialist_evaluations_total{status="error"}[30d]))
            /
            sum(rate(neural_hive_specialist_evaluations_total[30d]))
          )
        aggregation: availability
        labels:
          status: ".*"
      enabled: true
      metadata:
        owner: "ml-platform-team"
        review_frequency: "quarterly"
        business_impact: "critical"
        justification: "Model availability ensures system does not depend on heuristic fallbacks"
