apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "semantic-translation-engine.configMapName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "semantic-translation-engine.labels" . | nindent 4 }}
data:
  ENVIRONMENT: {{ .Values.config.environment | quote }}
  LOG_LEVEL: {{ .Values.config.logLevel | quote }}

  # Kafka Configuration
  KAFKA_BOOTSTRAP_SERVERS: {{ .Values.config.kafka.bootstrapServers | quote }}
  KAFKA_CONSUMER_GROUP_ID: {{ .Values.config.kafka.consumerGroupId | quote }}
  KAFKA_TOPICS: {{ .Values.config.kafka.topics | toJson | quote }}
  KAFKA_PLANS_TOPIC: {{ .Values.config.kafka.plansTopic | quote }}
  KAFKA_SECURITY_PROTOCOL: {{ .Values.config.kafka.securityProtocol | quote }}
  KAFKA_SASL_MECHANISM: {{ .Values.config.kafka.saslMechanism | quote }}

  # Schema Registry Configuration
  SCHEMA_REGISTRY_URL: {{ .Values.config.schemaRegistry.url | quote }}

  # Neo4j Configuration
  NEO4J_URI: {{ .Values.config.neo4j.uri | quote }}
  NEO4J_USER: {{ .Values.config.neo4j.user | quote }}
  NEO4J_DATABASE: {{ .Values.config.neo4j.database | quote }}
  NEO4J_QUERY_TIMEOUT_MS: {{ .Values.config.neo4j.queryTimeoutMs | quote }}
  NEO4J_MAX_CONNECTION_POOL_SIZE: {{ .Values.config.neo4j.maxConnectionPoolSize | quote }}

  # MongoDB Configuration
  MONGODB_URI: {{ .Values.config.mongodb.uri | quote }}
  MONGODB_DATABASE: {{ .Values.config.mongodb.database | quote }}
  MONGODB_CONTEXT_COLLECTION: {{ .Values.config.mongodb.contextCollection | quote }}
  MONGODB_LEDGER_COLLECTION: {{ .Values.config.mongodb.ledgerCollection | quote }}
  MONGODB_MAX_POOL_SIZE: {{ .Values.config.mongodb.maxPoolSize | quote }}

  # Redis Configuration
  REDIS_CLUSTER_NODES: {{ .Values.config.redis.clusterNodes | quote }}
  REDIS_CLUSTER_ENABLED: {{ .Values.config.redis.clusterEnabled | quote }}
  REDIS_SSL_ENABLED: {{ .Values.config.redis.sslEnabled | quote }}
  REDIS_DEFAULT_TTL: {{ .Values.config.redis.defaultTtl | quote }}
  REDIS_CACHE_ENABLED: {{ .Values.config.redis.cacheEnabled | quote }}

  # OpenTelemetry Configuration
  OTEL_ENDPOINT: {{ .Values.config.openTelemetry.endpoint | quote }}
  OTEL_SAMPLING_RATE: {{ .Values.config.openTelemetry.samplingRate | quote }}

  # Risk Scoring Configuration
  RISK_WEIGHT_PRIORITY: {{ .Values.config.riskScoring.weightPriority | quote }}
  RISK_WEIGHT_SECURITY: {{ .Values.config.riskScoring.weightSecurity | quote }}
  RISK_WEIGHT_COMPLEXITY: {{ .Values.config.riskScoring.weightComplexity | quote }}
  RISK_THRESHOLD_HIGH: {{ .Values.config.riskScoring.thresholdHigh | quote }}
  RISK_THRESHOLD_CRITICAL: {{ .Values.config.riskScoring.thresholdCritical | quote }}

  # Feature Flags
  KNOWLEDGE_GRAPH_ENABLED: {{ .Values.config.features.knowledgeGraphEnabled | quote }}
  LEDGER_ENABLED: {{ .Values.config.features.ledgerEnabled | quote }}
  EXPLAINABILITY_ENABLED: {{ .Values.config.features.explainabilityEnabled | quote }}
  CIRCUIT_BREAKER_ENABLED: {{ .Values.config.features.circuitBreakerEnabled | quote }}
