apiVersion: v1
kind: Secret
metadata:
  name: {{ include "gateway-intencoes.fullname" . }}-secret
  labels:
    {{- include "gateway-intencoes.labels" . | nindent 4 }}
type: Opaque
data:
  # Kafka SASL credentials (base64 encoded)
  kafka-username: {{ .Values.secrets.kafka.username | b64enc | quote }}
  kafka-password: {{ .Values.secrets.kafka.password | b64enc | quote }}

  # OAuth2 credentials for Kafka (if using OIDC)
  {{- if .Values.secrets.kafka.oauth2 }}
  kafka-oauth2-client-id: {{ .Values.secrets.kafka.oauth2.clientId | b64enc | quote }}
  kafka-oauth2-client-secret: {{ .Values.secrets.kafka.oauth2.clientSecret | b64enc | quote }}
  kafka-oauth2-token-endpoint: {{ .Values.secrets.kafka.oauth2.tokenEndpoint | b64enc | quote }}
  {{- end }}

  # mTLS certificates for Kafka (if using SSL client authentication)
  {{- if .Values.secrets.kafka.tls }}
  kafka-client-cert: {{ .Values.secrets.kafka.tls.clientCert | b64enc | quote }}
  kafka-client-key: {{ .Values.secrets.kafka.tls.clientKey | b64enc | quote }}
  kafka-ca-cert: {{ .Values.secrets.kafka.tls.caCert | b64enc | quote }}
  {{- end }}

  # JWT secret key for authentication
  jwt-secret-key: {{ .Values.secrets.jwtSecretKey | b64enc | quote }}

  # Redis secrets
  {{- if .Values.secrets.redis }}
  redis-password: {{ .Values.secrets.redis.password | b64enc | quote }}
  {{- if .Values.secrets.redis.caCert }}
  redis-ca-cert: {{ .Values.secrets.redis.caCert | quote }}
  {{- end }}
  {{- end }}

  # Keycloak secrets
  {{- if .Values.secrets.keycloak }}
  keycloak-client-secret: {{ .Values.secrets.keycloak.clientSecret | b64enc | quote }}
  {{- end }}

  # Schema Registry authentication (if required)
  {{- if .Values.secrets.schemaRegistry }}
  schema-registry-username: {{ .Values.secrets.schemaRegistry.username | b64enc | quote }}
  schema-registry-password: {{ .Values.secrets.schemaRegistry.password | b64enc | quote }}
  {{- end }}