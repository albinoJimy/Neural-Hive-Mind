apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "memory-layer-api.fullname" . }}-config
  labels:
    {{- include "memory-layer-api.labels" . | nindent 4 }}
data:
  # Application
  environment: {{ .Values.config.environment | quote }}
  log_level: {{ .Values.config.logLevel | quote }}
  debug: {{ .Values.config.debug | quote }}

  # Redis
  redis_cluster_nodes: {{ .Values.config.redis.clusterNodes | quote }}
  redis_ssl_enabled: {{ .Values.config.redis.sslEnabled | quote }}
  redis_default_ttl: {{ .Values.config.redis.defaultTtl | quote }}
  redis_max_ttl: {{ .Values.config.redis.maxTtl | quote }}

  # MongoDB
  mongodb_database: {{ .Values.config.mongodb.database | quote }}
  mongodb_context_collection: {{ .Values.config.mongodb.contextCollection | quote }}
  mongodb_lineage_collection: {{ .Values.config.mongodb.lineageCollection | quote }}
  mongodb_quality_collection: {{ .Values.config.mongodb.qualityCollection | quote }}
  mongodb_retention_days: {{ .Values.config.mongodb.retentionDays | quote }}

  # Neo4j
  neo4j_uri: {{ .Values.config.neo4j.uri | quote }}
  neo4j_user: {{ .Values.config.neo4j.user | quote }}
  neo4j_database: {{ .Values.config.neo4j.database | quote }}
  neo4j_query_timeout: {{ .Values.config.neo4j.queryTimeout | quote }}

  # ClickHouse
  clickhouse_host: {{ .Values.config.clickhouse.host | quote }}
  clickhouse_port: {{ .Values.config.clickhouse.port | quote }}
  clickhouse_user: {{ .Values.config.clickhouse.user | quote }}
  clickhouse_database: {{ .Values.config.clickhouse.database | quote }}
  clickhouse_retention_months: {{ .Values.config.clickhouse.retentionMonths | quote }}

  # Observability
  otel_endpoint: {{ .Values.config.otel.endpoint | quote }}
  prometheus_port: {{ .Values.config.prometheus.port | quote }}
  jaeger_sampling_rate: {{ .Values.config.jaeger.samplingRate | quote }}

  # Roteamento de Queries
  hot_data_threshold_seconds: {{ .Values.config.routing.hotDataThresholdSeconds | quote }}
  warm_data_threshold_days: {{ .Values.config.routing.warmDataThresholdDays | quote }}
  cold_data_threshold_months: {{ .Values.config.routing.coldDataThresholdMonths | quote }}

  # Data Quality
  quality_check_enabled: {{ .Values.config.quality.checkEnabled | quote }}
  completeness_threshold: {{ .Values.config.quality.completenessThreshold | quote }}
  accuracy_threshold: {{ .Values.config.quality.accuracyThreshold | quote }}
  freshness_threshold_hours: {{ .Values.config.quality.freshnessThresholdHours | quote }}

  # Feature Flags
  enable_cache: {{ .Values.config.features.enableCache | quote }}
  enable_lineage_tracking: {{ .Values.config.features.enableLineageTracking | quote }}
  enable_quality_monitoring: {{ .Values.config.features.enableQualityMonitoring | quote }}
  enable_auto_routing: {{ .Values.config.features.enableAutoRouting | quote }}
