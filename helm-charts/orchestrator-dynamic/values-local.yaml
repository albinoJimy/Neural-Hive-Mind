deployment:
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0

# Local development values for orchestrator-dynamic
# Override production values for local Kubernetes clusters

# Reduced replica count for local development
replicaCount: 1
# Desabilitar service links para evitar conflito de env vars do Kubernetes
# (SERVICE_REGISTRY_PORT sendo setado como tcp://... em vez de int)
enableServiceLinks: false
image:
  pullPolicy: IfNotPresent
  repository: 37.60.241.150:30500/orchestrator-dynamic
  tag: latest
# Custom command for local development
customCommand:
  enabled: true
  command: ["uvicorn"]
  args: ["src.main:app", "--host", "0.0.0.0", "--port", "8000", "--workers", "1"]
# Reduced resources for local development (~50% of production)
resources:
  requests:
    cpu: 50m
    memory: 512Mi
  limits:
    cpu: 50m
    memory: 2Gi
# Disable autoscaling for local development
autoscaling:
  enabled: false
# Disable pod disruption budget for local development
podDisruptionBudget:
  enabled: false
# Disable service monitor for local development
serviceMonitor:
  enabled: false
# Disable network policies for local development
networkPolicy:
  enabled: false
# Disable Istio for local development
istio:
  enabled: false
# Application configuration
config:
  serviceName: orchestrator-dynamic
  serviceVersion: "1.0.0"
  environment: dev
  logLevel: DEBUG
  # Temporal configuration - HABILITADO (Temporal Server instalado)
  temporal:
    enabled: true
    host: temporal-frontend.temporal.svc.cluster.local
    port: 7233
    namespace: default
    taskQueue: orchestration-tasks
    tlsEnabled: false
  # PostgreSQL configuration for Temporal - no SSL
  postgres:
    host: postgresql.default.svc.cluster.local
    port: 5432
    database: temporal
    sslMode: disable
  # Kafka configuration - no TLS/SASL for local
  kafka:
    bootstrapServers: neural-hive-kafka-kafka-bootstrap.kafka.svc.cluster.local:9092
    consensusTopic: plans.consensus
    ticketsTopic: execution.tickets
    consumerGroupId: orchestrator-dynamic
    securityProtocol: PLAINTEXT
  # MongoDB configuration - no authentication for local
  mongodb:
    uri: mongodb://mongodb.mongodb-cluster.svc.cluster.local:27017/orchestrator?authSource=admin
    database: orchestrator
  # Redis configuration - no SSL for local
  redis:
    clusterNodes: neural-hive-cache.redis-cluster.svc.cluster.local:6379
    sslEnabled: false
  # Scheduler configuration
  scheduler:
    enableIntelligentScheduler: false
    maxParallelTickets: 50
  # SLA configuration
  sla:
    defaultTimeoutMs: 1800000
    checkIntervalSeconds: 30
    alertThresholdPercent: 0.8
  # Retry configuration
  retry:
    maxAttempts: 2
    initialIntervalMs: 1000
    backoffCoefficient: 2.0
    maxIntervalMs: 30000
  # Observability configuration
  observability:
    otelExporterEndpoint: http://opentelemetry-collector.observability.svc.cluster.local:4317
    prometheusPort: 9090
  # OPA Policy Engine - disabled for local
  opa:
    enabled: false
    host: opa.neural-hive.svc.cluster.local
    port: 8181
    timeoutSeconds: 2
    retryAttempts: 3
    cacheTtlSeconds: 30
    failOpen: true
    policies:
      maxConcurrentTickets: 50
      allowedCapabilities:
        - code_generation
        - testing
        - validation
      resourceLimits:
        maxCpu: "2000m"
        maxMemory: "4Gi"
    featureFlags:
      intelligentSchedulerEnabled: false
      burstCapacityEnabled: false
      burstThreshold: 0.8
      predictiveAllocationEnabled: false
      autoScalingEnabled: false
      schedulerNamespaces:
        - default
      premiumTenants: []
  # ML configuration - disabled for local
  ml:
    trainingJob:
      enabled: false
    drift:
      enabled: false
  # SPIFFE/SPIRE - disabled for local (not installed)
  spiffe:
    enabled: false
  # Vault - disabled for local (not installed)
  vault:
    enabled: false
# Disable OPA deployment for local development
opa:
  enabled: false
# Use default service account for local
serviceAccount:
  create: false
  name: default
# Simplified secrets for local development
secrets:
  postgresUser: temporal
  postgresPassword: temporal
  mongodbUri: mongodb://root:local_dev_password@mongodb.mongodb-cluster.svc.cluster.local:27017/orchestrator?authSource=admin
  kafkaSaslUsername: ""
  kafkaSaslPassword: ""
  redisPassword: ""
# Relaxed probes for local development
# StartupProbe permite inicialização lenta (até 5 minutos)
startupProbe:
  httpGet:
    path: /health
    port: 8000
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30
livenessProbe:
  httpGet:
    path: /health
    port: 8000
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
readinessProbe:
  httpGet:
    path: /ready
    port: 8000
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# Force pods to node with insecure registry configured
nodeSelector:
  kubernetes.io/hostname: vmi2911681
