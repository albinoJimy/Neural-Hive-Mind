apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "orchestrator-dynamic.configMapName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "orchestrator-dynamic.labels" . | nindent 4 }}
data:
  SERVICE_NAME: {{ .Values.config.serviceName | quote }}
  SERVICE_VERSION: {{ .Values.config.serviceVersion | quote }}
  ENVIRONMENT: {{ .Values.config.environment | quote }}
  LOG_LEVEL: {{ .Values.config.logLevel | quote }}

  # Temporal
  TEMPORAL_HOST: {{ .Values.config.temporal.host | quote }}
  TEMPORAL_PORT: {{ .Values.config.temporal.port | quote }}
  TEMPORAL_NAMESPACE: {{ .Values.config.temporal.namespace | quote }}
  TEMPORAL_TASK_QUEUE: {{ .Values.config.temporal.taskQueue | quote }}
  TEMPORAL_TLS_ENABLED: {{ .Values.config.temporal.tlsEnabled | quote }}

  # Kafka
  KAFKA_BOOTSTRAP_SERVERS: {{ .Values.config.kafka.bootstrapServers | quote }}
  KAFKA_CONSENSUS_TOPIC: {{ .Values.config.kafka.consensusTopic | quote }}
  KAFKA_TICKETS_TOPIC: {{ .Values.config.kafka.ticketsTopic | quote }}
  KAFKA_CONSUMER_GROUP_ID: {{ .Values.config.kafka.consumerGroupId | quote }}
  KAFKA_SECURITY_PROTOCOL: {{ .Values.config.kafka.securityProtocol | quote }}

  # PostgreSQL
  POSTGRES_HOST: {{ .Values.config.postgres.host | quote }}
  POSTGRES_PORT: {{ .Values.config.postgres.port | quote }}
  POSTGRES_DATABASE: {{ .Values.config.postgres.database | quote }}
  POSTGRES_SSL_MODE: {{ .Values.config.postgres.sslMode | quote }}

  # MongoDB
  MONGODB_DATABASE: {{ .Values.config.mongodb.database | quote }}

  # Redis
  REDIS_CLUSTER_NODES: {{ .Values.config.redis.clusterNodes | quote }}
  REDIS_SSL_ENABLED: {{ .Values.config.redis.sslEnabled | quote }}

  # Scheduler
  ENABLE_INTELLIGENT_SCHEDULER: {{ .Values.config.scheduler.enableIntelligentScheduler | quote }}
  SCHEDULER_MAX_PARALLEL_TICKETS: {{ .Values.config.scheduler.maxParallelTickets | quote }}

  # SLA
  SLA_DEFAULT_TIMEOUT_MS: {{ .Values.config.sla.defaultTimeoutMs | quote }}
  SLA_CHECK_INTERVAL_SECONDS: {{ .Values.config.sla.checkIntervalSeconds | quote }}
  SLA_ALERT_THRESHOLD_PERCENT: {{ .Values.config.sla.alertThresholdPercent | quote }}

  # Retry
  RETRY_MAX_ATTEMPTS: {{ .Values.config.retry.maxAttempts | quote }}
  RETRY_INITIAL_INTERVAL_MS: {{ .Values.config.retry.initialIntervalMs | quote }}
  RETRY_BACKOFF_COEFFICIENT: {{ .Values.config.retry.backoffCoefficient | quote }}
  RETRY_MAX_INTERVAL_MS: {{ .Values.config.retry.maxIntervalMs | quote }}

  # Observability
  OTEL_EXPORTER_ENDPOINT: {{ .Values.config.observability.otelExporterEndpoint | quote }}
  PROMETHEUS_PORT: {{ .Values.config.observability.prometheusPort | quote }}
