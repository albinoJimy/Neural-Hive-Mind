# Prometheus Pushgateway - Configuração para Neural Hive Mind
# Usado para receber métricas de builds CI/CD

pushgateway:
  enabled: true

prometheus-pushgateway:
  fullnameOverride: "prometheus-pushgateway"

  replicaCount: 1

  image:
    repository: prom/pushgateway
    tag: "v1.6.2"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 9091
    targetPort: 9091

  serviceMonitor:
    enabled: true
    namespace: observability
    interval: 30s
    scrapeTimeout: 10s
    additionalLabels:
      prometheus: neural-hive
    honorLabels: true

  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 64Mi

  persistentVolume:
    enabled: false

  nodeSelector: {}

  tolerations: []

  affinity: {}

  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "9091"

  extraArgs:
    - --persistence.file=/data/pushgateway.data
    - --persistence.interval=5m
    - --web.enable-lifecycle
    - --web.enable-admin-api

  extraVolumes:
    - name: data
      emptyDir: {}

  extraVolumeMounts:
    - name: data
      mountPath: /data

# Configuração local (desenvolvimento)
local:
  ingress:
    enabled: false

# Configuração de produção
production:
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
      cert-manager.io/cluster-issuer: letsencrypt-prod
      nginx.ingress.kubernetes.io/auth-type: basic
      nginx.ingress.kubernetes.io/auth-secret: pushgateway-basic-auth
      nginx.ingress.kubernetes.io/auth-realm: "Authentication Required"
    hosts:
      - host: pushgateway.elysiumii.site
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: pushgateway-tls
        hosts:
          - pushgateway.elysiumii.site
