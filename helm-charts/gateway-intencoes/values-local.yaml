# Configurações locais simplificadas para desenvolvimento
deployment:
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0

image:
  repository: 37.60.241.150:30500/gateway-intencoes
  pullPolicy: Always
  tag: "1.1.2"
replicaCount: 1
serviceAccount:
  create: false
  name: "default"
initContainers:
  modelDownloader:
    enabled: false # Modelos já estão na imagem Docker
service:
  type: ClusterIP
  port: 80
  targetPort: 8000
ingress:
  enabled: false
# Gateway precisa de mais CPU para carregar modelos Whisper/spaCy
resources:
  limits:
    cpu: 2000m
    memory: 4Gi
  requests:
    cpu: 500m
    memory: 2Gi
autoscaling:
  enabled: false
# Force pods to node with insecure registry configured
nodeSelector:
  kubernetes.io/hostname: vmi2911681
tolerations: []
affinity: null
topologySpreadConstraints: []
podSecurityContext:
  fsGroup: 1001
  runAsGroup: 1001
  runAsUser: 1001
  runAsNonRoot: true
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop: [ALL]
  readOnlyRootFilesystem: false
  runAsNonRoot: true
# startupProbe dá tempo para inicialização lenta (carregar modelos, conectar serviços)
startupProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30
livenessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 0
  periodSeconds: 30
  timeoutSeconds: 10
  failureThreshold: 3
readinessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 0
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
config:
  environment: "dev"
  logLevel: "DEBUG"
  debug: true
  kafka:
    topics:
      enabled: false # Topics já foram criados manualmente
    bootstrapServers: "neural-hive-kafka-kafka-bootstrap.kafka.svc.cluster.local:9092"
    schemaRegistryUrl: "" # Sem schema registry no dev local
    tls:
      enabled: false
    sasl:
      enabled: false
    performance:
      batchSize: 16384
      lingerMs: 10
      compressionType: "snappy"
  redis:
    clusterNodes: "neural-hive-cache.redis-cluster.svc.cluster.local:6379"
    defaultTtl: 600
    maxConnections: 50
    poolSize: 10
    timeout: 5000
    retryOnTimeout: true
    ssl:
      enabled: false
  keycloak:
    url: "http://keycloak.keycloak.svc.cluster.local:8080"
    realm: "neural-hive"
    clientId: "gateway-intencoes"
    jwksUri: "http://keycloak.keycloak.svc.cluster.local:8080/realms/neural-hive/protocol/openid-connect/certs"
    tokenValidationEnabled: false # Desabilitar para dev inicial
  asr:
    modelName: "tiny" # Modelo menor para dev
    device: "cpu"
  nlu:
    languageModel: "pt_core_news_sm"
    confidenceThreshold: 0.75
  limits:
    maxAudioSizeMb: 10
    maxTextLength: 10000
  cors:
    allowedOrigins: ["*"]
    allowedHosts: ["*"]
secrets:
  jwtSecretKey: "dev-secret-key-change-in-production"
  kafka:
    username: ""
    password: ""
  redis:
    password: ""
  keycloak:
    clientSecret: "dev-client-secret"
serviceMonitor:
  enabled: false # Sem Prometheus operator no dev local
# Observabilidade - OpenTelemetry desabilitado para dev local, usando stubs
observability:
  otelEnabled: false  # Desabilitar OpenTelemetry em dev local para simplificar desenvolvimento
  otelEndpoint: "http://opentelemetry-collector.observability.svc.cluster.local:4317"
  prometheus:
    enabled: false # Desabilitar ServiceMonitor para dev local
networkPolicy:
  enabled: false # Simplificar para dev
podDisruptionBudget:
  enabled: false # Não necessário com 1 replica
istio:
  enabled: false
  sidecar:
    inject: false
  virtualService:
    enabled: false
  gateway:
    enabled: false
volumes:
  - name: model-cache
    emptyDir: {}
volumeMounts:
  - name: model-cache
    mountPath: /app/models
# Desabilitar persistence para dev local (usar emptyDir)
persistence:
  models:
    enabled: false
