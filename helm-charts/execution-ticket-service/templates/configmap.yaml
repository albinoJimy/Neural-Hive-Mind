{{- if .Values.config.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "execution-ticket-service.configMapName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "execution-ticket-service.labels" . | nindent 4 }}
data:
  SERVICE_NAME: {{ .Values.config.serviceName | quote }}
  ENVIRONMENT: {{ .Values.config.environment | quote }}
  LOG_LEVEL: {{ .Values.config.logLevel | quote }}

  # PostgreSQL Configuration
  POSTGRES_HOST: {{ .Values.config.postgres.host | quote }}
  POSTGRES_PORT: {{ .Values.config.postgres.port | quote }}
  POSTGRES_DATABASE: {{ .Values.config.postgres.database | quote }}
  POSTGRES_USER: {{ .Values.config.postgres.user | quote }}
  POSTGRES_SSL_MODE: {{ .Values.config.postgres.sslMode | quote }}

  # MongoDB Configuration
  MONGODB_DATABASE: {{ .Values.config.mongodb.database | quote }}

  # Kafka Configuration
  KAFKA_BOOTSTRAP_SERVERS: {{ .Values.config.kafka.bootstrapServers | quote }}
  KAFKA_CONSUMER_GROUP_ID: {{ .Values.config.kafka.consumerGroupId | quote }}
  KAFKA_TICKETS_TOPIC: {{ .Values.config.kafka.ticketsTopic | quote }}
  KAFKA_SECURITY_PROTOCOL: {{ .Values.config.kafka.securityProtocol | quote }}
  KAFKA_SASL_MECHANISM: {{ .Values.config.kafka.saslMechanism | quote }}
  KAFKA_SASL_USERNAME: {{ .Values.config.kafka.saslUsername | quote }}
  KAFKA_SASL_PASSWORD: {{ .Values.config.kafka.saslPassword | quote }}
  KAFKA_SSL_CA_LOCATION: {{ .Values.config.kafka.sslCaLocation | quote }}
  KAFKA_SSL_CERTIFICATE_LOCATION: {{ .Values.config.kafka.sslCertificateLocation | quote }}
  KAFKA_SSL_KEY_LOCATION: {{ .Values.config.kafka.sslKeyLocation | quote }}
  KAFKA_SCHEMA_REGISTRY_URL: {{ .Values.config.kafka.schemaRegistryUrl | quote }}
  SCHEMAS_BASE_PATH: {{ .Values.config.kafka.schemasBasePath | quote }}

  # JWT Configuration
  JWT_ALGORITHM: {{ .Values.config.jwt.algorithm | quote }}
  JWT_EXPIRATION_SECONDS: {{ .Values.config.jwt.expirationSeconds | quote }}

  # Webhooks Configuration
  WEBHOOKS_ENABLED: {{ .Values.config.webhooks.enabled | quote }}
  WEBHOOKS_TIMEOUT_SECONDS: {{ .Values.config.webhooks.timeoutSeconds | quote }}
  WEBHOOKS_MAX_RETRIES: {{ .Values.config.webhooks.maxRetries | quote }}

  # gRPC Configuration
  GRPC_PORT: {{ .Values.config.grpc.port | quote }}
  GRPC_MAX_WORKERS: {{ .Values.config.grpc.maxWorkers | quote }}

  # Observability Configuration
  OTEL_EXPORTER_ENDPOINT: {{ .Values.config.observability.otelExporterEndpoint | quote }}
  OTEL_EXPORTER_OTLP_ENDPOINT: {{ .Values.config.observability.otelExporterEndpoint | quote }}
  OTEL_SERVICE_NAME: {{ .Values.config.serviceName | quote }}
  OTEL_RESOURCE_ATTRIBUTES: "service.version={{ .Values.config.serviceVersion }},deployment.environment={{ .Values.config.environment }}"
  PROMETHEUS_PORT: {{ .Values.config.observability.prometheusPort | quote }}
{{- end }}
