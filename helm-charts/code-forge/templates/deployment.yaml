{{- $ctx := include "code-forge.context" . | fromYaml }}
{{- $checksumConfig := include (print $.Template.BasePath "/configmap.yaml") . | sha256sum }}

{{- $envFrom := list }}
{{- $envFrom = append $envFrom (dict "configMapRef" (dict "name" (include "code-forge.configMapName" .))) }}
{{- $envFrom = append $envFrom (dict "secretRef" (dict "name" (include "code-forge.secretName" .))) }}

{{- $config := dict "checksumConfig" $checksumConfig "envFrom" $envFrom }}

{{- include "neural-hive.deployment" (dict "values" .Values "context" $ctx "config" $config) }}
