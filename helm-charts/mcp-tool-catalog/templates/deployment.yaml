{{- $ctx := include "mcp-tool-catalog.context" . | fromYaml }}

{{- $env := list }}
{{- $env = append $env (dict "name" "SERVICE_VERSION" "value" .Values.image.tag) }}

{{- $envFrom := list }}
{{- $envFrom = append $envFrom (dict "configMapRef" (dict "name" (printf "%s-config" (include "mcp-tool-catalog.fullname" .)))) }}
{{- $envFrom = append $envFrom (dict "secretRef" (dict "name" (include "mcp-tool-catalog.fullname" .))) }}

{{- $config := dict "env" $env "envFrom" $envFrom }}

{{- include "neural-hive.deployment" (dict "values" .Values "context" $ctx "config" $config) }}
