apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "worker-agents.fullname" . }}
  labels:
    {{- include "worker-agents.labels" . | nindent 4 }}
data:
  SERVICE_NAME: {{ .Values.config.serviceName | quote }}
  NAMESPACE: {{ .Values.config.namespace | quote }}
  CLUSTER: {{ .Values.config.cluster | quote }}
  SUPPORTED_TASK_TYPES: {{ join "," .Values.config.supportedTaskTypes | quote }}
  MAX_CONCURRENT_TASKS: {{ .Values.config.maxConcurrentTasks | quote }}

  KAFKA_BOOTSTRAP_SERVERS: {{ .Values.config.kafka.bootstrapServers | quote }}
  KAFKA_TICKETS_TOPIC: {{ .Values.config.kafka.ticketsTopic | quote }}
  KAFKA_RESULTS_TOPIC: {{ .Values.config.kafka.resultsTopic | quote }}
  KAFKA_CONSUMER_GROUP_ID: {{ .Values.config.kafka.consumerGroupId | quote }}
  KAFKA_SECURITY_PROTOCOL: {{ .Values.config.kafka.securityProtocol | quote }}
  KAFKA_SASL_MECHANISM: {{ .Values.config.kafka.saslMechanism | quote }}
  KAFKA_SASL_USERNAME: {{ .Values.config.kafka.saslUsername | quote }}
  KAFKA_SASL_PASSWORD: {{ .Values.config.kafka.saslPassword | quote }}
  KAFKA_SSL_CA_LOCATION: {{ .Values.config.kafka.sslCaLocation | quote }}
  KAFKA_SSL_CERTIFICATE_LOCATION: {{ .Values.config.kafka.sslCertificateLocation | quote }}
  KAFKA_SSL_KEY_LOCATION: {{ .Values.config.kafka.sslKeyLocation | quote }}
  KAFKA_SCHEMA_REGISTRY_URL: {{ .Values.config.kafka.schemaRegistryUrl | quote }}
  SCHEMAS_BASE_PATH: {{ .Values.config.kafka.schemasBasePath | quote }}

  SERVICE_REGISTRY_HOST: {{ .Values.config.serviceRegistry.host | quote }}
  SERVICE_REGISTRY_PORT: {{ .Values.config.serviceRegistry.port | quote }}
  HEARTBEAT_INTERVAL_SECONDS: {{ .Values.config.serviceRegistry.heartbeatIntervalSeconds | quote }}

  EXECUTION_TICKET_SERVICE_URL: {{ .Values.config.executionTicketService.url | quote }}

  ENABLE_TEMPORAL_ACTIVITIES: {{ .Values.config.temporal.enabled | quote }}
  {{- if .Values.config.temporal.enabled }}
  TEMPORAL_HOST: {{ .Values.config.temporal.host | quote }}
  TEMPORAL_PORT: {{ .Values.config.temporal.port | quote }}
  TEMPORAL_NAMESPACE: {{ .Values.config.temporal.namespace | quote }}
  TEMPORAL_TASK_QUEUE: {{ .Values.config.temporal.taskQueue | quote }}
  {{- end }}

  OTEL_EXPORTER_ENDPOINT: {{ .Values.config.observability.otelEndpoint | quote }}
  PROMETHEUS_PORT: {{ .Values.config.observability.prometheusPort | quote }}
  HTTP_PORT: {{ .Values.config.observability.httpPort | quote }}
  LOG_LEVEL: {{ .Values.config.observability.logLevel | quote }}
